<div class="container-fluid page">
  <div class="header">
    <div class="row d-flex align-items-center justify-content-between">
      <div class="col-md-8 dash"> <i class="bi bi-speedometer2"></i>&nbsp; Dashboard</div>
      <div class="col-md-4 comdtl">
        <span class="comname">{{organisationName}} <br></span>
        <hr>
        <i class="bi bi-envelope-fill"></i>&nbsp; Email : {{organisationEmail}}<br>
        <i class="bi bi-telephone-fill"></i>&nbsp; Contact Number : {{organisationContact}}<br>
        <i class="bi bi-geo-alt-fill"></i>&nbsp; Address : {{organisationAddress}}, Pin - {{organisationPin}}
      </div>
    </div>
  </div>
  <!-- billDetailsScrool -->
  <div class="row">
    <div class="col-12 p-1 billscrl">
      <marquee width="90%" direction="left" onmouseover="this.stop();" onmouseout="this.start();">
        *** Your Bill is due from 20th January,2023. Please Complete Your Payment to Continue Your Service. ***
      </marquee>
    </div>
  </div>

  <!-- maincontent -->
  <div class="main p-4">
    <div class="row">
      <div class="col-8 dashbox">
        <div class="row">
          <div class="item col-3 active act me-2">
            <i class="bi bi-person-fill botic"></i>
            <h3>Active Student</h3>
            <hr class="rule">
            <a [routerLink]="['/StudentCourseRegistration']">
              <h1><b>{{totalNoActiveStudent}}</b></h1>
            </a>
          </div>
          <div class="item  col-3 active act1 me-2">
            <i class="bi bi-book-fill botic"></i>
            <h3>Active Student</h3>
            <hr class="rule">
            <a [routerLink]="['/course']">
              <h1><b>{{totalNoCourse}}</b></h1>
            </a>
          </div>
          <div class="item col-3 active act2 me-2">
            <i class="bi bi-wallet-fill botic"></i>
            <h3>Cash Received (Year)</h3>
            <hr class="rule">
            <a [routerLink]="['/AllIncomeReport']">
              <h1><b>{{totalYearlyCash | currency:'INR'}}</b></h1>
            </a>
          </div>
          <div class="item col-3 active act3 me-2">
            <i class="bi bi-bank2 botic"></i>
            <h3>Bank Received (Year) </h3>
            <hr class="rule">
            <a [routerLink]="['/AllIncomeReport']">
              <h1><b>{{totalYearlyBank | currency:'INR'}}</b></h1>
            </a>
          </div>
        </div>

        <!-- tabhere 
      <a href="#top">Back to top of page</a>-->
        <div class="thtab upcom mt-4">
          <div class="lefttabs">
            <i class="bi bi-bell-fill"></i>&nbsp; All Reports
            <mat-tab-group (selectedIndexChange)="onTabChanged($event)" [(selectedIndex)]="selectedIndex"
              animationDuration="200ms">
              <mat-tab>
                <ng-template mat-tab-label>
                  <i class="bi bi-bar-chart-fill"></i> &nbsp;
                  Monthly Income
                </ng-template>
                <div class="card mb-3">
                  <!-- <div class="card-header" style="color:black ;">
                          <i class="bi bi-bar-chart-fill"></i> Bar Chart Example
                        </div> -->
                  <div class="card-body">

                    <div style="display: block;">
                      <canvas baseChart width="700" height="250" [type]="'line'" [data]="lineChartData"
                        [options]="lineChartOptions" [legend]="lineChartLegend">
                      </canvas>
                    </div>

                  </div>

                </div>
              </mat-tab>

              <mat-tab>
                <ng-template mat-tab-label>
                  <mat-icon class="example-tab-icon">list</mat-icon>
                  Admission No
                </ng-template>
                <div class="card mb-3">
                  <div class="card-header">
                    <i class="fa fa-bar-chart"></i> Bar Chart Example
                  </div>
                  <div class="card-body">
                    <div class="row">
                      <div class="col-sm-8 my-auto">
                        <canvas id="myBarChart" width="100" height="50"></canvas>
                      </div>
                      <div class="col-sm-4 text-center my-auto">
                        <div class="h4 mb-0 text-primary">$34,693</div>
                        <div class="small text-muted">YTD Revenue</div>
                        <hr>
                        <div class="h4 mb-0 text-warning">$18,474</div>
                        <div class="small text-muted">YTD Expenses</div>
                        <hr>
                        <div class="h4 mb-0 text-success">$16,219</div>
                        <div class="small text-muted">YTD Margin</div>
                      </div>
                    </div>
                  </div>
                  <div class="card-footer small text-muted">Updated yesterday at 11:59 PM</div>
                </div>
              </mat-tab>

              <mat-tab>
                <ng-template mat-tab-label>
                  <mat-icon class="example-tab-icon">thumb_up</mat-icon>
                  Upcoming Birthday
                </ng-template>

                <!-------------------------------start show Receipt bill voucher------------------------------------- -->
                <div class="container" *ngIf="showReceipt">

                  <div id="print-AllReceiptBill-owner">
                    <div style="border: 2px dotted rgb(1, 1, 19);">
                      <div class="row">
                        <!-- <div class="col-2 ">
                          <img src="assets/img/baitLogo.png" width="100px" alt="AdminLTE Logo" style="opacity: .8">
                        </div> -->
                        <div class="col-12" align="center">

                          <p
                            style="margin-bottom: 0 ;margin-top: 0 ; font-size: large; font-family: 'Cooper Black'; font-weight: bolder;">
                            <!-- Barrackpore Academy Of Information Technology -->{{organisationName}}
                          </p>
                          <p style="margin-bottom: 0 ;margin-top: 0 ; font-size: medium;">{{organisationAddress}},
                            Pin:{{organisationPin}}</p>
                          <p style="margin-bottom: 0 ;margin-top: 0 ; font-size: medium;">
                            E-mail: &nbsp;{{organisationEmail}} | Contact: {{organisationContact}}</p>

                          <hr style="height:2px;border-width:0;color:gray;background-color:gray">
                        </div>

                      </div>

                    </div>
                    <div class="row">
                      <div class="col-7">
                        <table>
                          <tr>
                            <td>Student Name</td>
                            <td>:</td>
                            <th>{{billing_name}}</th>
                          </tr>
                          <tr>
                            <td>Contact No</td>
                            <td>:</td>
                            <th>{{whatsapp_number}}</th>
                          </tr>
                          <tr>
                            <td>Course Name</td>
                            <td>:</td>
                            <th>{{full_name}}</th>
                          </tr>
                        </table>
                      </div>
                      <div class="col-5">
                        <table>
                          <tr>
                            <td>Total Course Fees</td>
                            <td>:</td>
                            <th>{{total_course_fees | currency: 'INR'}}</th>
                          </tr>

                        </table>
                      </div>
                      <div class="row">
                        <div class="col-md text-center">
                          <table style="border-collapse: collapse; width: 100%; margin:0 auto;">
                            <thead>
                              <tr
                                style="border-top: 3px dotted rgb(1, 1, 19);border-bottom: 3px dotted rgb(116, 114, 114);background-color:rgb(196, 190, 190);padding: 0.5;">
                                <th>Sl No</th>
                                <th>Date</th>
                                <!--  <th>Receipt No</th> -->
                                <th>Fees Name</th>
                                <th>Comments</th>
                                <th class="text-right">Amount</th>
                              </tr>
                            </thead>
                            <tbody>
                              <tr *ngFor="let receipt of allBillReceiptArray; let i = index">

                                <td>{{i+1}}</td>
                                <td>{{receipt.transaction_date | date:'dd/MM/yyyy'}}</td>
                                <!-- <td>{{receipt.transaction_number }}</td> -->
                                <td>{{receipt.ledger_name}}</td>
                                <td>{{receipt.comment}}</td>
                                <td class="text-right">{{receipt.temp_total_received | currency: 'INR'}}</td>
                              </tr>

                            </tbody>
                            <tfoot>

                              <tr style="background-color: lightgrey; border-top: 1px solid rgb(1, 1, 19);">
                                <th colspan="3">&nbsp;</th>
                                <td class="text-right">Grand Total:</td>
                                <th class="text-right">{{totalRecepitAmount | currency: 'INR'}}</th>
                                <th>&nbsp;</th>
                              </tr>
                              <tr style="background-color: lightgrey; border-top: 1px solid rgb(1, 1, 19);">
                                <th colspan="3">&nbsp;</th>
                                <td class="text-right">Total Discount:</td>
                                <th class="text-right">- &nbsp;{{total_discount | currency:
                                  'INR'}}
                                </th>
                                <th>&nbsp;</th>
                              </tr>
                              <tr>
                                <th>In Words:</th>
                                <td>:</td>
                                <th colspan="3" class="text-left">{{rupeeInWords}}</th>
                              </tr>
                              <tr style="background-color: lightgrey; border: 1px solid rgb(1, 1, 19);">
                                <th colspan="3">&nbsp;</th>
                                <td class="text-right">Current Due</td>
                                <th class="text-right">{{(total_course_fees - totalRecepitAmount)-total_discount |
                                  currency: 'INR'}}</th>
                                <th>&nbsp;</th>

                              </tr>
                            </tfoot>
                          </table>
                        </div>
                      </div>
                      <div class="row" style="font-size: small;">
                        <div class="col-7">
                          Notice:<p style="margin-bottom: 0 ;margin-top: 0 ; font-style: oblique; font-size: small;">1)
                            It
                            is Computer Generated Bill</p>
                          <p style="margin-bottom: 0 ;margin-top: 0 ;font-style: oblique;">2) Advanced Fees Cannot be
                            Refund.</p>

                        </div>
                        <div class="col-3 ">
                          <p class="text-right">Signature</p>
                          <p class="text-right">-----------------</p>
                        </div>
                      </div>

                    </div>
                  </div>
                  <div mat-dialog-actions>
                    <button class="btn btn-danger" (click)="onClickedClosed()">Close</button>
                    <button class="btn btn-success" printSectionId="print-AllReceiptBill-owner"
                      printTitle="Develop By BAIT" ngxPrint>Print</button>

                  </div>
                </div>
                <!-------------------------------end show Receipt bill voucher------------------------------------- -->
              </mat-tab>
            </mat-tab-group>
          </div>
        </div>
      </div>
      <!-- bdaytable -->
      <div class="col-4 bday">
        <div class="upcom-1">
          <div class="upbday">
            <i class="bi bi-bell-fill"></i>&nbsp; Upcoming Birthday
            <span> <a [routerLink]="['/UpcomingBirthday']">
             &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<b>Click To View All</b>
            </a></span>
          </div>
          <div class="upcom-1-scroll">
            <table class="table table-hover">
              <thead>
                <tr>
                  <th scope="col">#</th>
                  <th scope="col">Name</th>
                  <th scope="col">What's No</th>
                  <th scope="col">DOB</th>
                  <th scope="col">Day Left</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let item of birthdayArray; let indexOfelement=index;">
                  <th scope="row">{{indexOfelement+1}}</th>
                  <td>{{item.ledger_name}}</td>
                  <td>{{item.whatsapp_number}}</td>
                  <td>{{item.dob | date: 'dd/MM/yyyy'}}</td>
                  <td>{{item.PandingDays}}</td>
                </tr>

              </tbody>
            </table>
          </div>
        </div>

        <!-- Duelist -->
        <div class="upcom-2 mt-4">
          <div class="upbday">
            <i class="bi bi-bell-fill"></i>&nbsp; Upcoming Duelist
            <span> <a [routerLink]="['/UpcomingDue']">
              &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<b>Click To View All</b>
             </a></span>
          </div>
          <div class="upcom-2-scroll">
            <table class="table table-hover">
              <thead>
                <tr>
                  <th scope="col">#</th>
                  <th scope="col">Name</th>
                  <th scope="col">What's No</th>
                  <th scope="col">Tran Date</th>
                  <th scope="col">Amount</th>
                  <th scope="col">Days</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let item of upcomingDueListArray; let indexOfelement=index;">
                  <th scope="row">{{indexOfelement+1}}</th>
                  <td>{{item.student_name}}</td>
                  <td>{{item.whatsapp_number}}</td>
                  <td>{{item.transaction_date | date: 'dd/MM/yyyy'}}</td>
                  <td>{{item.total_due | currency:'INR'}}</td>
                  <td>{{item.date_Diff}}</td>
                </tr>

              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
    <!-- monthly/yearlydetai;s -->
    <div class="row mt-4">
      <div class="col-3 mon me-3 p-4">
        <div class="mhead mb-3">TOTAL MONTHLY INCOME</div>
        <div class="mbody"><i class="bi bi-cash-stack"></i>&nbsp;{{totalMonthlyIncome | currency:'INR'}}</div>
      </div>
      <div class="col-3 mon me-3 p-4">
        <div class="mhead mb-3">TOTAL MONTHLY CASH</div>
        <div class="mbody"><i class="bi bi-cash-stack"></i>&nbsp;{{totalMonthlyCash | currency:'INR'}}</div>
      </div>
      <div class="col-3 mon me-3 p-4">
        <div class="mhead mb-3">TOTAL MONTHLY BANK</div>
        <div class="mbody"><i class="bi bi-cash-stack"></i>&nbsp;{{totalMonthlyBank | currency:'INR'}}</div>
      </div>
      <div class="col-3 mon p-4">
        <div class="mhead mb-3">TOTAL YEARLY INCOME</div>
        <div class="mbody"><i class="bi bi-cash-stack"></i>&nbsp;{{totalYearlyIncome | currency:'INR'}}</div>
      </div>
    </div>
    <!-- student history details -->
    <div class="row mt-4 upcom">
      <div class="stuhisdtl">
        <i class="bi bi-person-video"></i>
        &nbsp; Student History Details
      </div>
      <div class="stutable">


        <p-table #studentRegistrationHistory [value]="studentRegistrationHistoryArray" dataKey="id" [paginator]="true"
          [rows]="5" [showCurrentPageReport]="true"
          currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
          [rowsPerPageOptions]="[5,10,25,50]" [globalFilterFields]="['ledger_name','full_name','effective_date']">

          <ng-template pTemplate="caption">
            <div class="flex">
              <button pButton label="Clear" class="p-button-outlined" icon="pi pi-filter-slash"
                (click)="clear(studentRegistrationHistory)"></button>
              <span class="p-input-icon-left ml-auto">
                <i class="pi pi-search"></i>
                <input pInputText type="text"
                  (input)="studentRegistrationHistory.filterGlobal(getEventValue($event), 'contains')"
                  placeholder="Search keyword" />
              </span>

            </div>
          </ng-template>
          <ng-template pTemplate="header">
            <tr>
              <th>ID</th>
              <th pSortableColumn="ledger_id">Student Name <p-sortIcon field="ledger_name"></p-sortIcon>
              </th>
              <th pSortableColumn="course_id">Course Name <p-sortIcon field="full_name"></p-sortIcon>
              </th>
              <th>Contact No</th>
              <th pSortableColumn="effective_date">Admission Date <p-sortIcon field="effective_date"></p-sortIcon>
              </th>
              <th pSortableColumn="is_completed">Status<p-sortIcon field="is_completed"></p-sortIcon>
              </th>
              <th>Total Course Fees</th>
              <th>Total Received</th>
              <th>Total Due</th>
            </tr>
          </ng-template>
          <ng-template pTemplate="body" let-course>

            <tr>
              <td><button pButton class="p-button-rounded p-button-info p-button-outlined"
                  (click)="onClickedReceiptVoucher(course.id)">
                  <i class="bi bi-printer"> </i>
                </button></td>
              <td>{{course.ledger_name}}</td>
              <td>{{course.full_name}}</td>
              <td>{{course.whatsapp_number}}</td>
              <td>{{course.effective_date | date: 'dd/MM/yyyy'}}</td>
              <td>{{course.is_completed}}</td>
              <!-- <a [routerLink]="['/FeesCharge']" style="text-decoration:none ; color: black; text-align:center;"><td>{{course.total_course_fees | currency:'INR'}}</td></a> -->
              <td>{{course.total_course_fees | currency:'INR'}}</td>
              <td>{{course.total_received | currency:'INR'}}</td>
              <td>{{course.total_due | currency:'INR'}}</td>
            </tr>
          </ng-template>
          <ng-template pTemplate="paginatorleft">
            <p-button type="button" icon="pi pi-plus" styleClass="p-button-text"></p-button>
          </ng-template>
        </p-table>

      </div>
    </div>

    <!-- Auto Generate Fees Charge details -->
    <div class="row mt-4 upcom">
      <div class="stuhisdtl">
        <i class="bi bi-person-video"></i>
        &nbsp; Monthly Auto Generate Fees Charge
      </div>
      <div class="p-2 text-right">
        <button type="button" class="btn btn-success" (click)="saveAllStudentMonthly()">
          Generate All Fees Charged
        </button>
      </div>
      <div class="stutable">


        <p-table #monthlyStudent [value]="monthlyStudentArray" dataKey="id" [paginator]="true" [rows]="5"
          [showCurrentPageReport]="true" currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
          [rowsPerPageOptions]="[5,10,25,50]" [globalFilterFields]="['ledger_name','full_name','transaction_date']">

          <ng-template pTemplate="caption">
            <div class="flex">
              <button pButton label="Clear" class="p-button-outlined" icon="pi pi-filter-slash"
                (click)="clear(monthlyStudent)"></button>
              <span class="p-input-icon-left ml-auto">
                <i class="pi pi-search"></i>
                <input pInputText type="text" (input)="monthlyStudent.filterGlobal(getEventValue($event), 'contains')"
                  placeholder="Search keyword" />
              </span>

            </div>
          </ng-template>
          <ng-template pTemplate="header">
            <tr>
              <th>ID</th>

              <th pSortableColumn="ledger_id">Student Name <p-sortIcon field="ledger_name"></p-sortIcon>
              </th>
              <th pSortableColumn="course_id">Course Name <p-sortIcon field="full_name"></p-sortIcon>
              </th>

              <th pSortableColumn="transaction_date">Transaction Date <p-sortIcon field="transaction_date"></p-sortIcon>
              </th>
              <th pSortableColumn="fees_month">Month No.<p-sortIcon field="fees_month"></p-sortIcon>
              </th>
              <th>amount</th>

            </tr>
          </ng-template>
          <ng-template pTemplate="body" let-course let-rowIndex="rowIndex">

            <tr>
              <td>{{rowIndex+1}}</td>
              <td>{{course.ledger_name}}</td>
              <td>{{course.full_name}}</td>
              <td>{{course.transaction_date | date: 'dd/MM/yyyy'}}</td>
              <td>{{course.fees_month}}</td>
              <td>{{course.amount | currency:'INR'}}</td>

            </tr>
          </ng-template>
          <ng-template pTemplate="paginatorleft">
            <p-button type="button" icon="pi pi-plus" styleClass="p-button-text"></p-button>
          </ng-template>
        </p-table>

      </div>
    </div>
  </div>

</div>